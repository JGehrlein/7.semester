---
title: "Microbial diversity"
author: "Jonas Gehrlein"
date: "23 nov 2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(vegan)
library(here)
library(ampvis2)
library(rethinking)
library(seqinr)
library(ape)
library(phytools)
```

## R Markdown


```{r cars}
otutable <- read.delim(here('data','Fly_paper','otutable.txt'),header = TRUE, check.names = FALSE)
metadata <- read.table(here('data','Fly_paper','metadata.txt'),check.names = FALSE, sep = '\t', header = TRUE)
unifrac <- read.table(here('data','Fly_paper','beta_div_OTUS','OTUS.unweighted_unifrac.txt'))
wunifrac <- read.table(here('data','Fly_paper','beta_div_OTUS','OTUS.weighted_unifrac.txt'))
```

```{r}
data <- amp_load(otutable = otutable, metadata = metadata)
col_v <- c(colnames(metadata[,5:10]))
p <- rep(NA, 12)
for (i in col_v){
  data$abund <- unifrac
NMDS_u <- amp_ordinate(data, type = 'NMDS', distmeasure = 'none',
                      detailed_output = TRUE, transform = 'none',
                       k = 10, try = 20, trymax = 50,
                      filter_species = 0, sample_color_by = i)
NMDS_u$plot

data$abund <- wunifrac
NMDS_w <- amp_ordinate(data, type = 'NMDS', distmeasure = 'none',
                      detailed_output = TRUE, transform = 'none',
                       k = 10, try = 20, trymax = 50,
                      sample_color_by = i)
NMDS_w
}
data$abund <- unifrac
NMDS <- amp_ordinate(data, type = 'NMDS', distmeasure = 'none',
                      detailed_output = TRUE, transform = 'none',
                       k = 10, try = 20, trymax = 50,
                      filter_species = 0, sample_color_by = 'Sample_Type')
NMDS$plot

data$abund <- wunifrac
NMDS <- amp_ordinate(data, type = 'NMDS', distmeasure = 'none',
                      detailed_output = TRUE, transform = 'none',
                       k = 10, try = 20, trymax = 50,
                      filter_species = 0,sample_color_by = 'Sample_Type')
NMDS$plot
```

```{r}
```

